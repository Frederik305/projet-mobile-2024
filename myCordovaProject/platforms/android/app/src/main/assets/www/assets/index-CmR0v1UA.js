function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/GLTFLoader-Lm1hKXOz.js","assets/three.module-CwjCRhry.js","assets/index-BVBvlU2g.js","assets/_commonjsHelpers-CqkleIqs.js","assets/nipplejs-PhMyn1IT.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();class y{constructor(e,t,i,a,n,s,o,r,c,A,g,h,m,u){this.id=e,this.name=t,this.model=i,this.level=a,this.price=n,this.acceleration=s,this.baseMaxSpeed=o,this.weight=r,this.brakePower=c,this.maneuverability=A,this.rotation=g,this.cameraDistance=h,this.cameraRotationY=m,this.cameraRotationX=u}}class E{constructor(){this.cars=[{id:0,name:"Muscle",model:"Muscle.glb",level:0,price:5e3,acceleration:1,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuverability:20,rotation:.01,cameraDistance:900,cameraRotationY:500,cameraRotationX:0},{id:1,name:"Sedan",model:"Sedan.glb",level:5,price:5e3,acceleration:.75,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuverability:10,rotation:.01,cameraDistance:800,cameraRotationY:400,cameraRotationX:0},{id:2,name:"Police car",model:"Police Muscle.glb",price:5e3,level:10,acceleration:1.1,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.009,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:3,name:"Gino",model:"Muscle 2.glb",level:15,price:5e3,acceleration:1.1,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.009,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:4,name:"Hatchback",model:"Hatchback.glb",level:0,price:5e3,acceleration:.9,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.009,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:5,name:"Sport",model:"Sports.glb",level:0,price:5e3,acceleration:1.5,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.01,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:6,name:"Pickup",model:"Pickup.glb",level:0,price:5e3,acceleration:1.5,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.01,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:7,name:"Taxi",model:"Taxi.glb",level:0,price:5e3,acceleration:1.5,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.01,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:8,name:"Van",model:"Van.glb",level:0,price:5e3,acceleration:1.5,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.01,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0},{id:9,name:"SUV",model:"SUV.glb",level:0,price:5e3,acceleration:1.5,baseMaxSpeed:80,weight:1e3,brakePower:1,maneuverability:.02,rotation:.01,cameraDistance:1e3,cameraRotationY:400,cameraRotationX:0}]}getCars(){for(let e in this.cars){let t=new y(this.cars[e].id,this.cars[e].name,this.cars[e].model,this.cars[e].level,this.cars[e].price,this.cars[e].acceleration,this.cars[e].baseMaxSpeed,this.cars[e].weight,this.cars[e].brakePower,this.cars[e].maneuverability,this.cars[e].rotation,this.cars[e].cameraDistance,this.cars[e].cameraRotationY,this.cars[e].cameraRotationX);this.cars[t.id]=t}return console.log(this.cars),this.cars}}class f{constructor(e,t,i,a,n,s,o){this.id=e,this.username=t,this.highscore=i,this.picture=a,this.level=n,this.cash=s,this.carsUnlocked=o}}class w{constructor(){this.html=document.getElementById("html-vue-player").innerHTML,this.actionModifierPlayer=null}initializeActionModifierPlayer(e){this.actionModifierPlayer=e}afficher(e){document.getElementsByTagName("body")[0].innerHTML=this.html,this.fileInput=document.getElementById("fileInput"),this.photoPlayer=document.getElementById("output"),this.photoPlayer.src=e.picture,this.fileInput.addEventListener("change",this.handleFileSelect.bind(this)),document.getElementById("username").value=e.username,document.getElementById("modifier-player").addEventListener("click",t=>{this.enregistrer(e)})}handleFileSelect(e){const t=e.target.files;if(t.length>0){const i=t[0],a=new FileReader;a.onload=n=>{const s=n.target.result;this.photoPlayer.src=`${s}`},a.readAsDataURL(i)}}enregistrer(e){let t=document.getElementById("username").value,i=document.getElementById("output").src;this.actionModifierPlayer(new f(e.id,t,e.highscore,i,e.level,e.cash,e.carsUnlocked))}}const I="modulepreload",M=function(l){return"/"+l},p={},d=function(e,t,i){let a=Promise.resolve();if(t&&t.length>0){const n=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.all(t.map(r=>{if(r=M(r),r in p)return;p[r]=!0;const c=r.endsWith(".css"),A=c?'[rel="stylesheet"]':"";if(!!i)for(let m=n.length-1;m>=0;m--){const u=n[m];if(u.href===r&&(!c||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${A}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":I,c||(h.as="script",h.crossOrigin=""),h.href=r,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((m,u)=>{h.addEventListener("load",m),h.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${r}`)))})}))}return a.then(()=>e()).catch(n=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=n,window.dispatchEvent(s),!s.defaultPrevented)throw n})};class P{constructor(){this.html=document.getElementById("html-vue-home-page").innerHTML,this.carList=null,this.player=null,this.selectedCar=0,this.carPositions=[],this.isAnimating=!1,this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initializeHomePage(e,t){this.carList=e,this.player=t}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.getElementById("name").innerText="Name: "+this.carList[this.selectedCar].name,document.getElementById("acceleration").innerText="Acceleration: "+this.carList[this.selectedCar].acceleration,document.getElementById("maneuverability").innerText="Maniability: "+this.carList[this.selectedCar].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.carList[this.selectedCar].brakePower,document.getElementById("btn-start").href=`#Game/${this.selectedCar}`,document.getElementById("username-player-home-page").innerHTML=this.player.username,document.getElementById("photo-player-home-page").src=this.player.picture,document.getElementById("high-score-player").innerHTML+=this.player.highscore}checkCarsOwned(){this.player.carsUnlocked.includes(this.selectedCar)?console.log("car already owned",this.selectedCar):console.log("car not owned",this.selectedCar)}loadTexture(){this.player.carsUnlocked.includes(this.selectedCar)&&(console.log(this.carModel),new this.THREE.TextureLoader().load("NotOwned.png",t=>{this.carModel.traverse(i=>{i.isMesh&&(i.material.map=t,i.material.side=this.THREE.FrontSide,i.material.transparent=!0,i.material.opacity=.5,i.material.alphaTest=.5,i.material.needsUpdate=!0)})}))}async setup(){try{const[e,{GLTFLoader:t},{default:i},a,n]=await Promise.all([d(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),d(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),d(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([])),d(()=>import("./index-BVBvlU2g.js").then(s=>s.i),__vite__mapDeps([2,3])),d(()=>import("./cannon-es-B7qhRxk4.js"),__vite__mapDeps([]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=i,this.ZingTouch=a,this.CANNON=n,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.renderer.setSize(e,t),document.body.appendChild(this.renderer.domElement);const i=this.createGradientBackground();this.scene.background=i,this.addLights()}createGradientBackground(){const e=document.createElement("canvas"),t=e.getContext("2d"),i=t.createLinearGradient(0,0,0,window.innerHeight);return t.fillStyle=i,t.fillRect(0,0,e.width,e.height),new this.THREE.CanvasTexture(e)}addLights(){const e=new this.THREE.AmbientLight(16777215,2),t=new this.THREE.DirectionalLight(16777215,7);t.position.set(10,20,-10),this.scene.add(e,t)}async loader(){const e=new this.GLTFLoader;for(let t=0;t<this.carList.length;t++)try{const i=await new Promise((s,o)=>{e.load(this.carList[t].model,s,void 0,o)}),a=await new Promise((s,o)=>{e.load("Parking.glb",s,void 0,o)});this.carModel=i.scene,this.carModel.position.set(t*-400,0,0),this.carModel.rotateY(Math.PI),this.carPositions.push(this.carModel.position);const n=a.scene;n.position.set(t*-400,0,0),n.rotateY(Math.PI),this.scene.add(this.carModel),this.scene.add(n)}catch(i){console.error(i)}}setLinkSelectedCar(){this.updateLinkSelectedCar()}updateLinkSelectedCar(){document.getElementById("name").innerText="Name: "+this.carList[this.selectedCar].name,document.getElementById("acceleration").innerText="Acceleration: "+this.carList[this.selectedCar].acceleration,document.getElementById("maneuverability").innerText="Maniability: "+this.carList[this.selectedCar].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.carList[this.selectedCar].brakePower,document.getElementById("btn-start").href=`#Game/${this.selectedCar}`}appendSceneToDiv(){let e=document.getElementById("threejs-container");e?e.appendChild(this.renderer.domElement):console.error("Container not found")}catchSwipeEvent(){var e=document.getElementById("swipeCatcher"),t=new this.ZingTouch.Region(e);t.bind(e,"swipe",i=>{if(i.detail.data[0].currentDirection<=270&&i.detail.data[0].currentDirection>=90&&!this.isAnimating&&this.selectedCar+1<this.carList.length&&(this.selectedCar++,this.updateLinkSelectedCar(),this.moveCameraPositionRight(),this.checkCarsOwned()),(i.detail.data[0].currentDirection>=270||i.detail.data[0].currentDirection<=90)&&!this.isAnimating){if(this.selectedCar<=0)return;this.selectedCar--,this.updateLinkSelectedCar(),this.moveCameraPositionLeft(),this.checkCarsOwned()}})}setCameraPosition(){this.camera.position.set(this.carPositions[this.selectedCar].x+400,300,-800),console.log(this.carPositions[this.selectedCar].x),this.camera.lookAt(this.carPositions[this.selectedCar].clone().add(new this.THREE.Vector3(0,0,-100)))}moveCameraPositionLeft(){this.isAnimating=!0;let e=this.camera.position.x+400,t={x:this.camera.position.x};new this.TWEEN.Tween(t).to({x:e},500).easing(this.TWEEN.Easing.Quartic.Out).onUpdate(()=>{this.camera.position.x=t.x}).onComplete(()=>{this.isAnimating=!1}).start()}moveCameraPositionRight(){this.isAnimating=!0;let e=this.camera.position.x-400,t={x:this.camera.position.x};new this.TWEEN.Tween(t).to({x:e},500).easing(this.TWEEN.Easing.Quartic.Out).onUpdate(()=>{this.camera.position.x=t.x}).onComplete(()=>{this.isAnimating=!1}).start()}animate(){requestAnimationFrame(()=>this.animate()),this.TWEEN.update(),this.renderer.render(this.scene,this.camera)}startAnimation(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}}async init(){this.startAnimation(),this.setLinkSelectedCar(),await this.loader(),this.setCameraPosition(),this.appendSceneToDiv(),this.catchSwipeEvent(),this.checkCarsOwned()}}class b{constructor(){this.html=document.getElementById("html-vue-game").innerHTML,this.scene=null,this.camera=null,this.renderer=null,this.THREE=null,this.GLTFLoader=null,this.TWEEN=null,this.nipplejs=null,this.car,this.carModel,this.setup=this.setup.bind(this),this.tickInterval=1e3/120,this.lastTick=0,this.frameCount=0,this.fpsCounter=document.createElement("div"),this.isPaused=!1,this.lastFpsUpdate=Date.now(),this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initialiserCar(e){this.car=e}getGameScore(){return(Math.abs(this.carModel.position.z)*this.score/1e4).toFixed(0)}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.body.appendChild(this.fpsCounter),this.score=0,this.carInstances=[],this.roadInstances=[],this.maxRoadInstances=8,this.nextRoadPositionCounter=0,this.distanceAhead=-1e3,this.fpsCounter.style.position="absolute",this.fpsCounter.style.top="10px",this.fpsCounter.style.left="10px",this.fpsCounter.style.color="white",this.fpsCounter.style.fontFamily="Arial, sans-serif",this.speed=this.car.baseMaxSpeed}async setup(){try{const[e,{GLTFLoader:t},{default:i},a,n]=await Promise.all([d(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),d(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),d(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([])),d(()=>import("./nipplejs-PhMyn1IT.js").then(s=>s.n),__vite__mapDeps([4,3])),d(()=>import("./cannon-es-B7qhRxk4.js"),__vite__mapDeps([]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=i,this.nipplejs=a,this.cannonjs=n,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){document.body.appendChild(this.renderer.domElement),this.scene.background=new this.THREE.Color(11063551),this.scene.fog=new this.THREE.FogExp2(12575709,7e-5)}addStart(){new this.GLTFLoader().load("rooad.glb",t=>{const i=t.scene;this.scene.add(i)},void 0,t=>{console.error(t)})}async loadRoad(){return new Promise((e,t)=>{new this.GLTFLoader().load("untitled.glb",a=>{const n=a.scene;e(n)},void 0,a=>{t(a)})})}async addRoad(){for(;this.roadInstances.length<this.maxRoadInstances;)try{const e=await this.loadRoad(),t=this.calculateRoadLength(e);this.nextRoadPositionCounter++;let i=this.nextRoadPositionCounter*-t;e.position.z=i,this.scene.add(e),this.roadInstances.push(e)}catch(e){console.error(e)}}calculateRoadLength(e){return new this.THREE.Box3().setFromObject(e).getSize(new this.THREE.Vector3).z}getTotalRoadLength(){let e=0;for(const t of this.roadInstances){const a=new this.THREE.Box3().setFromObject(t).getSize(new this.THREE.Vector3);e+=a.z}return e}moveRoadBehind(){if(this.roadInstances.length>0&&this.carModel&&this.carModel.position.z+7e3<this.roadInstances[0].position.z){const e=this.getTotalRoadLength();this.roadInstances[0].position.z-=e,this.roadInstances.push(this.roadInstances.shift()),this.carsGeneration()}}async loadCars(){const e=[{file:"Sedan.glb",weight:4},{file:"Police Muscle.glb",weight:2},{file:"Muscle 2.glb",weight:3},{file:"Limousine.glb",weight:1},{file:"Bus.glb",weight:2},{file:"Muscle.glb",weight:3},{file:"Firetruck.glb",weight:1},{file:"Hatchback.glb",weight:4},{file:"Ambulance.glb",weight:2},{file:"Sports.glb",weight:2}],t=12;for(;this.carInstances.length<t;){let i=0;for(let c=0;c<e.length;c++)i+=e[c].weight;const a=Math.random()*i;let n,s=0;for(let c=0;c<e.length;c++)if(s+=e[c].weight,a<=s){n=e[c].file;break}let r=(await this.loadModel(n)).scene;r.scale.set(1.5,1.5,1.5),r.position.z=1e4,this.scene.add(r),this.carInstances.push(r)}}loadModel(e){return new Promise((t,i)=>{new this.GLTFLoader().load(e,t,void 0,i)})}carsGeneration(){function e(){let s=[0,0,1];for(let o=s.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[s[o],s[r]]=[s[r],s[o]]}return s}let t=this.roadInstances,i=this.carInstances;function a(s){for(let r=0;r<s.length;r++)s[r]===0&&Math.floor(Math.random()*100)<20&&(s[r]=1);for(let r=0;r<3;r++)if(s[r]==0){let c=r===0?-600:r===1?0:600;const A=Math.random()*100-50;c+=A;const g=Math.random()*2e3-1e3,h=t[3].position.z+g;i[0].position.x=c,i[0].position.z=h,i.push(i.shift())}}let n=e();a(n)}addLights(){const e=new this.THREE.AmbientLight(16777215,3),t=new this.THREE.DirectionalLight(16777215,5);t.position.set(1,1,1),this.scene.add(e,t)}loadCar(){return new Promise((e,t)=>{const i=this.car.model;this.loadModel(i).then(a=>{this.carModel=a.scene,this.carModel.position.set(0,1,0),this.carModel.rotateY(Math.PI),this.carModel.scale.set(1.2,1.2,1.2),this.scene.add(this.carModel),e()}).catch(a=>{console.error(a),t(a)})})}mouvements(){let e;const t=this.car.rotation,i=document.getElementById("joystick-container"),a=this.nipplejs.create({zone:i,mode:"dynamic",color:"yellow"});a.on("move",(n,s)=>{if(s&&s.direction){const o=s.direction.x;o==="right"?e&&e>s.distance?this.carModel.rotation.y>0&&(this.carModel.rotation.y-=t):this.carModel.rotation.y<.3&&(this.carModel.rotation.y+=t*(s.distance/50)):o==="left"&&(e&&e>s.distance?this.carModel.rotation.y<0&&(this.carModel.rotation.y+=t):this.carModel.rotation.y>-.3&&(this.carModel.rotation.y-=t*(s.distance/50))),e=s.distance}}),a.on("end",()=>{const n=()=>{Math.abs(this.carModel.rotation.y)>.01?(this.carModel.rotation.y>0?this.carModel.rotation.y-=t:this.carModel.rotation.y<0&&(this.carModel.rotation.y+=t),requestAnimationFrame(n)):this.carModel.rotation.y=0};n()})}moveCarForward(){const e=this.carModel.rotation.y,t=Math.sin(e)*this.speed,i=-Math.cos(e)*this.speed;this.carModel.position.x<=800&&this.carModel.position.x>=-800&&(this.carModel.position.x+=t,this.carModel.position.x>800?this.carModel.position.x=800:this.carModel.position.x<-800&&(this.carModel.position.x=-800)),this.carModel.position.z+=i}setCameraPosition(){const e=new this.THREE.Vector3(this.car.cameraRotationX,this.car.cameraRotationY,this.car.cameraDistance),t=new this.THREE.Vector3;t.copy(this.carModel.position).add(e),this.camera.position.copy(t),this.camera.lookAt(this.carModel.position),this.camera.rotation.x-=-.2}async update(){if(!this.isPaused){this.frameCount++;const e=Date.now(),t=e-this.lastTick,i=e-this.lastFpsUpdate;if(i>=1e3){const n=Math.round(this.frameCount*1e3/i);this.fpsCounter.textContent=`FPS: ${n}`,this.frameCount=0,this.lastFpsUpdate=e}if(t>=this.tickInterval&&(this.frameCount%5===0&&this.updateScore(),this.frameCount%100===0&&this.speedIncrease(),this.lastTick=e-t%this.tickInterval),t>=this.tickInterval){this.TWEEN.update();try{this.moveRoadBehind(),this.moveCarForward(),this.setCameraPosition(),this.renderer.render(this.scene,this.camera)}catch(n){console.error("Error in game loop:",n)}this.lastTick=e-t%this.tickInterval}this.detectCollision(this.carModel,this.carInstances)&&(window.location.hash="EndScreen",this.isPaused=!0)}}updateScore(){if(!this.isPaused){this.score++;let e=this.getGameScore();document.getElementById("Score").innerHTML="SCORE: "+e}}speedIncrease(){this.isPaused||(this.speed+=this.car.acceleration)}animate(){requestAnimationFrame(()=>{this.update(),this.animate()})}changePauseState(){this.isPaused=!this.isPaused,console.log(this.isPaused);const e=document.getElementById("Score"),t=document.getElementById("test");this.isPaused?(document.getElementById("joystick-container").style.display="none",document.getElementById("Pause").style.display="none",document.getElementById("game-pause").style.display="flex",t.appendChild(e),e.style.backgroundColor="#444444d3"):(document.getElementById("game-pause").style.display="none",document.getElementById("Pause").style.display="block",document.getElementById("joystick-container").style.display="block",document.getElementById("container-score-pause").appendChild(e),e.style.backgroundColor="#49494977")}checkButtonClick(){document.getElementById("Pause").addEventListener("pointerdown",()=>{this.isPaused||this.changePauseState()}),document.getElementById("resume").addEventListener("pointerdown",()=>{this.isPaused&&this.changePauseState()}),document.getElementById("quit-btn").addEventListener("click",()=>{this.isPaused||this.changePauseState(),document.getElementById("game-pause").style.display="none"})}startGameLoop(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.renderer.render(this.scene,this.camera)}}async init(){await this.loadCar(),this.addStart(),this.addLights(),this.mouvements(),this.checkButtonClick(),await this.addRoad(),await this.loadCars(),this.startGameLoop(),this.isPaused=!1}detectCollision(e,t){const i=new this.THREE.Box3().setFromObject(e),a=.6;i.getSize(new this.THREE.Vector3).multiplyScalar(a);for(let s=0;s<t.length;s++){const o=new this.THREE.Box3().setFromObject(t[s]),r=o.getSize(new this.THREE.Vector3);if(r.multiplyScalar(a),o.setFromCenterAndSize(o.getCenter(new this.THREE.Vector3),r),i.intersectsBox(o))return console.log("Collision detected!"),!0}return!1}}class v{constructor(){this.html=document.getElementById("html-vue-end-screen").innerHTML,this.car,this.score}afficher(){document.getElementById("game-over-container").innerHTML+=this.html,document.getElementById("restart-btn").href=`#Game/${this.car.id}`,document.getElementById("game-score").innerHTML="SCORE: "+this.score}initialiserVueEndScreen(e,t){this.car=e,this.score=t}}class C{constructor(){this.player={},this.defaultplayer={id:0,username:"Player1",highscore:0,picture:"data:image/jpeg;base64,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",level:1,cash:1e4,carsUnlocked:[0,1,4]}}getPlayer(){localStorage.player?this.player=JSON.parse(localStorage.player):(localStorage.player=JSON.stringify(this.defaultplayer),this.player=JSON.parse(localStorage.player));let e=new f(this.player.id,this.player.username,this.player.highscore,this.player.picture,this.player.level,this.player.cash,this.player.carsUnlocked);return this.player=e,console.log(this.player.level),this.player}modifierInfoPlayer(e){console.log(e.id),this.player?(this.player.username=e.username,this.player.picture=e.picture,this.player.highscore=e.highscore,this.player.level=e.level,this.player.cash=e.cash,this.player.carsUnlocked=e.carsUnlocked,localStorage.player=JSON.stringify(this.player)):console.error("Le player avec l'ID spécifié n'existe pas.")}modifierHighscore(e){this.player&&(this.player.highscore=e,localStorage.player=JSON.stringify(this.player))}modifierLevel(e){this.player&&(e=parseInt(e),e/=(this.player.level+10)*15745,this.player.level+=e,localStorage.player=JSON.stringify(this.player))}isRegistered(){return localStorage.player?(this.player=JSON.parse(localStorage.player),!0):!1}}class R{constructor(e,t,i,a,n,s,o){this.window=e,this.playerDAO=o,this.carDAO=t,this.vuePlayer=s,this.vueHomePage=i,this.vueGame=a,this.vueEndScreen=n,this.idItem,this.vuePlayer.initializeActionModifierPlayer(r=>this.actionModifierPlayer(r)),this.window.addEventListener("hashchange",()=>this.naviger()),this.naviger(),this.hasInitGame=!1,this.hasInitHomePage=!1}naviger(){let e=window.location.hash;if(!e)this.vuePlayer.afficher(this.playerDAO.getPlayer());else if(e.match(/^#HomePage/))this.vueHomePage.initializeHomePage(this.carDAO.getCars(),this.playerDAO.getPlayer()),this.vueHomePage.afficher(),this.vueHomePage.setup().then(()=>{this.hasInitHomePage==!1?(this.vueHomePage.init(),this.hasInitHomePage=!0):location.reload()}).catch(t=>console.error(t));else if(e.match(/^#Game\/([0-9]+)/)){let t=e.match(/^#Game\/([0-9]+)/);this.idItem=t[1],this.vueGame.initialiserCar(this.carDAO.getCars()[this.idItem]),this.vueGame.afficher(),this.vueGame.setup().then(()=>{this.hasInitGame==!1?(this.vueGame.init(),this.hasInitGame=!0):location.reload()}).catch(i=>console.error(i))}else e.match(/^#EndScreen/)&&(this.vueEndScreen.initialiserVueEndScreen(this.carDAO.getCars()[this.idItem],this.vueGame.getGameScore()),this.vueEndScreen.afficher(),parseInt(this.vueGame.getGameScore())>parseInt(this.playerDAO.getPlayer().highscore)&&this.playerDAO.modifierHighscore(this.vueGame.getGameScore()),console.log(this.playerDAO.getPlayer().level),this.playerDAO.modifierLevel(this.vueGame.getGameScore()),console.log(this.playerDAO.getPlayer().level))}actionModifierPlayer(e){this.playerDAO.modifierInfoPlayer(e),this.window.location.hash="#"}}new R(window,new E,new P,new b,new v,new w,new C);
