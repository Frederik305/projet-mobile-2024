function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/GLTFLoader-Lm1hKXOz.js","assets/three.module-CwjCRhry.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();class g{constructor(e,t,i,n,s,a,m,o,d,f,p,r){this.id=e,this.name=t,this.model=i,this.acceleration=n,this.baseMaxSpeed=s,this.weight=a,this.brakePower=m,this.maneuverability=o,this.rotation=d,this.cameraDistance=f,this.cameraRotationY=p,this.cameraRotationX=r}}class E{constructor(){this.cars=[{id:0,name:"Muscle",model:"Muscle.glb",acceleration:1.5,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuvrability:20,rotation:.03,cameraDistance:800,cameraRotationY:400,cameraRotationX:0},{id:1,name:"Sedan",model:"Sedan.glb",acceleration:2,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuvrability:10,rotation:.03,cameraDistance:800,cameraRotationY:400,cameraRotationX:0},{id:2,name:"Mazda rx7",model:"mazda_rx7_stylised.glb",acceleration:1.1,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuvrability:10,rotation:.03,cameraDistance:800,cameraRotationY:400,cameraRotationX:0}]}getCars(){for(let e in this.cars){let t=new g(this.cars[e].id,this.cars[e].name,this.cars[e].model,this.cars[e].acceleration,this.cars[e].baseMaxSpeed,this.cars[e].weight,this.cars[e].brakePower,this.cars[e].maneuvrability,this.cars[e].rotation,this.cars[e].cameraDistance,this.cars[e].cameraRotationY,this.cars[e].cameraRotationX);this.cars[t.id]=t}return console.log(this.cars),this.cars}}const y="modulepreload",R=function(c){return"/"+c},w={},h=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),m=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.all(t.map(o=>{if(o=R(o),o in w)return;w[o]=!0;const d=o.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(!!i)for(let l=s.length-1;l>=0;l--){const u=s[l];if(u.href===o&&(!d||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${f}`))return;const r=document.createElement("link");if(r.rel=d?"stylesheet":y,d||(r.as="script",r.crossOrigin=""),r.href=o,m&&r.setAttribute("nonce",m),document.head.appendChild(r),d)return new Promise((l,u)=>{r.addEventListener("load",l),r.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})}))}return n.then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};class v{constructor(){this.html=document.getElementById("html-vue-home-page").innerHTML,this.displayHomePage=null,this.selectedCar=0,this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initializeHomePage(e){this.displayHomePage=e}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.getElementById("name").innerText="Name: "+this.displayHomePage[this.selectedCar].name,document.getElementById("acceleration").innerText="Acceleration: "+this.displayHomePage[this.selectedCar].acceleration,document.getElementById("maneuverability").innerText="Maneuverability: "+this.displayHomePage[this.selectedCar].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.displayHomePage[this.selectedCar].brakePower,document.getElementById("btn-start").href=`#Game/${this.selectedCar}`}async setup(){try{const[e,{GLTFLoader:t},{default:i},n]=await Promise.all([h(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),h(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),h(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([])),h(()=>import("./index-CtozVBx0.js").then(s=>s.i),__vite__mapDeps([]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=i,this.ZingTouch=n,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.renderer.setSize(e,t),document.body.appendChild(this.renderer.domElement);const i=this.createGradientBackground();this.scene.background=i,this.addLights()}createGradientBackground(){const e=document.createElement("canvas"),t=e.getContext("2d"),i=t.createLinearGradient(0,0,0,window.innerHeight);return t.fillStyle=i,t.fillRect(0,0,e.width,e.height),new this.THREE.CanvasTexture(e)}addLights(){const e=new this.THREE.AmbientLight(16777215,2),t=new this.THREE.DirectionalLight(16777215,7);t.position.set(10,20,-10),this.scene.add(e,t)}loader(){new this.GLTFLoader().load("HomeView.glb",t=>{const i=t.scene;i.position.set(0,0,0),i.rotateY(Math.PI),this.scene.add(i)},void 0,t=>{console.error(t)})}setLinkSelectedCar(){const e=this.selectedCar;this.updateLinkSelectedCar(e)}updateLinkSelectedCar(e){document.getElementById("name").innerText="Name: "+this.displayHomePage[e].name,document.getElementById("acceleration").innerText="Acceleration: "+this.displayHomePage[e].acceleration,document.getElementById("maneuverability").innerText="Maneuverability: "+this.displayHomePage[e].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.displayHomePage[e].brakePower,document.getElementById("btn-start").href=`#Game/${e}`}appendSceneToDiv(){let e=document.getElementById("threejs-container");e?e.appendChild(this.renderer.domElement):console.error("Container not found")}catchSwipeEvent(){var e=document.getElementById("threejs-container"),t=new this.ZingTouch.Region(e);let i=this.selectedCar;t.bind(e,"swipe",n=>{if(console.log(n.detail),console.log(n.detail.data[0].currentDirection),n.detail.data[0].currentDirection<=225&&n.detail.data[0].currentDirection>=135)if(console.log("left"),i<=0){console.log("premiere voiture");return}else i--,console.log(i),this.updateLinkSelectedCar(i);else(n.detail.data[0].currentDirection>=315||n.detail.data[0].currentDirection<=45)&&(console.log("right"),i++,console.log(i),this.updateLinkSelectedCar(i))})}setCameraPosition(){this.camera.position.set(400,400,-800),this.camera.lookAt(0,0,0)}animate(){requestAnimationFrame(()=>this.animate()),this.TWEEN.update(),this.renderer.render(this.scene,this.camera)}startAnimation(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}}init(){this.setupScene(),this.startAnimation(),this.setLinkSelectedCar(),this.setCameraPosition(),this.loader(),this.appendSceneToDiv(),this.catchSwipeEvent()}}class T{constructor(){this.html=document.getElementById("html-vue-game").innerHTML,this.scene=null,this.camera=null,this.renderer=null,this.THREE=null,this.GLTFLoader=null,this.TWEEN=null,this.car,this.carModel,this.setup=this.setup.bind(this),this.tickInterval=1e3/60,this.lastTick=0,this.frameCount=0,this.fpsCounter=document.createElement("div"),this.fpsCounter.style.position="absolute",this.fpsCounter.style.top="10px",this.fpsCounter.style.left="10px",this.fpsCounter.style.color="white",this.fpsCounter.style.fontFamily="Arial, sans-serif",this.lastFpsUpdate=Date.now(),this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initialiserCar(e){this.car=e}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.body.appendChild(this.fpsCounter),this.roadInstances=[],this.maxRoadInstances=2,this.nextRoadPositionCounter=0,this.distanceAhead=-1e3}async setup(){try{const[e,{GLTFLoader:t},{default:i}]=await Promise.all([h(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),h(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),h(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=i,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.scene.background=new this.THREE.Color(11063551),this.scene.fog=new this.THREE.FogExp2(12575709,12e-5)}addStart(){new this.GLTFLoader().load("rooad.glb",t=>{const i=t.scene;this.scene.add(i)},void 0,t=>{console.error(t)})}async loadRoad(){return new Promise((e,t)=>{new this.GLTFLoader().load("untitled.glb",n=>{const s=n.scene;e(s)},void 0,n=>{t(n)})})}async addRoad(){for(;this.roadInstances.length<=this.maxRoadInstances+1;)try{const e=await this.loadRoad();this.nextRoadPositionCounter++;let t=this.nextRoadPositionCounter*-1e4;e.position.z=t,this.scene.add(e),this.roadInstances.push(e)}catch(e){console.error(e)}}async callRoad(){return new Promise(async(e,t)=>{if(this.carModel){let i=this.nextRoadPositionCounter*-1e4;Math.abs(this.carModel.position.z-i-this.maxRoadInstances*1e4)<=1e3&&await this.addRoad(),e()}else console.warn("Car model is not loaded yet."),t(new Error("Car model is not loaded yet."))})}clearRoadBehind(){if(this.roadInstances.length>0&&this.carModel&&this.carModel.position.z+7e3<this.roadInstances[0].position.z){const e=this.roadInstances.shift();this.scene.remove(e)}}addLights(){const e=new this.THREE.AmbientLight(16777215,3),t=new this.THREE.DirectionalLight(16777215,5);t.position.set(1,1,1),this.scene.add(e,t)}loadCar(){return new Promise((e,t)=>{new this.GLTFLoader().load(this.car.model,n=>{this.carModel=n.scene,this.carModel.position.set(0,1,0),this.carModel.rotateY(Math.PI),this.carModel.scale.set(.8,.8,.8),this.scene.add(this.carModel),e()},void 0,n=>{console.error(n),t(n)})})}mouvements(){const e=this.car.rotation,t={LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,pressedKeys:{},isDown:function(i){return this.pressedKeys[i]},onKeyDown:function(i){this.pressedKeys[i.keyCode]=!0},onKeyUp:function(i){delete this.pressedKeys[i.keyCode]}};document.addEventListener("keydown",i=>{t.onKeyDown(i),i.code==="ArrowLeft"?this.carModel.rotation.y>-.3&&(this.carModel.rotation.y-=e):i.code==="ArrowRight"&&this.carModel.rotation.y<.3&&(this.carModel.rotation.y+=e)}),document.addEventListener("keyup",i=>{if(t.onKeyUp(i),!t.isDown(t.LEFT_ARROW)&&!t.isDown(t.RIGHT_ARROW)){const n=()=>{Math.abs(this.carModel.rotation.y)>.01?(this.carModel.rotation.y>0?this.carModel.rotation.y-=e:this.carModel.rotation.y<0&&(this.carModel.rotation.y+=e),requestAnimationFrame(n)):this.carModel.rotation.y=0};n()}}),document.getElementById("button-left").addEventListener("mousedown",()=>{const i=setInterval(()=>{this.carModel.rotation.y>-.3&&(this.carModel.rotation.y-=e)},10);document.addEventListener("mouseup",()=>{clearInterval(i),this.reduceRotation()})}),document.getElementById("button-right").addEventListener("mousedown",()=>{const i=setInterval(()=>{this.carModel.rotation.y<.3&&(this.carModel.rotation.y+=e)},10);document.addEventListener("mouseup",()=>{clearInterval(i),this.reduceRotation()})}),this.reduceRotation=()=>{const i=()=>{Math.abs(this.carModel.rotation.y)>.01?(this.carModel.rotation.y>0?this.carModel.rotation.y-=e:this.carModel.rotation.y<0&&(this.carModel.rotation.y+=e),requestAnimationFrame(i)):this.carModel.rotation.y=0};i()}}moveCarForward(){const e=this.car.baseMaxSpeed+50,t=this.carModel.rotation.y,i=Math.sin(t)*e,n=-Math.cos(t)*e;this.carModel.position.x+=i,this.carModel.position.z+=n}setCameraPosition(){const e=new this.THREE.Vector3(this.car.cameraRotationX,this.car.cameraRotationY,this.car.cameraDistance),t=new this.THREE.Vector3;t.copy(this.carModel.position).add(e),this.camera.position.copy(t),this.camera.lookAt(this.carModel.position),this.camera.rotation.x-=-.2}async update(){this.frameCount++;const e=Date.now(),t=e-this.lastTick,i=e-this.lastFpsUpdate;if(i>=1e3){const n=Math.round(this.frameCount*1e3/i);this.fpsCounter.textContent=`FPS: ${n}`,this.frameCount=0,this.lastFpsUpdate=e}if(t>=this.tickInterval){this.TWEEN.update();try{this.callRoad(),this.clearRoadBehind(),this.moveCarForward(),this.setCameraPosition(),this.renderer.render(this.scene,this.camera)}catch(n){console.error("Error in game loop:",n)}this.lastTick=e-t%this.tickInterval}}animate(){requestAnimationFrame(()=>{this.update(),this.animate()})}startGameLoop(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}}async init(){this.setupScene(),await this.loadCar(),this.addStart(),await this.addRoad(),await this.callRoad(),this.addLights(),this.mouvements(),this.startGameLoop()}}class L{constructor(){this.html=document.getElementById("html-vue-end-screen").innerHTML}afficher(){console.log("afficher")}}class P{constructor(e,t,i,n,s){this.window=e,this.carDAO=t,this.vueHomePage=i,this.vueGame=n,this.vueEndScreen=s,this.window.addEventListener("hashchange",()=>this.naviger()),this.naviger()}naviger(){let e=window.location.hash;if(!e)this.vueHomePage.initializeHomePage(this.carDAO.getCars()),this.vueHomePage.afficher(),this.vueHomePage.setup().then(()=>{this.vueHomePage.init()}).catch(t=>console.error(t));else if(e.match(/^#Game\/([0-9]+)/)){let i=e.match(/^#Game\/([0-9]+)/)[1];this.vueGame.initialiserCar(this.carDAO.getCars()[i]),this.vueGame.afficher(),this.vueGame.setup().then(()=>{this.vueGame.init()}).catch(n=>console.error(n))}else e.match(/^#EndScreen/)&&this.vueEndScreen.afficher()}}new P(window,new E,new v,new T,new L);
