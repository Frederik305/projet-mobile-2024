function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/GLTFLoader-Lm1hKXOz.js","assets/three.module-CwjCRhry.js","assets/index-BVBvlU2g.js","assets/_commonjsHelpers-CqkleIqs.js","assets/nipplejs-PhMyn1IT.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();class E{constructor(e,t,n,i,s,o,m,a,d,g,p,c){this.id=e,this.name=t,this.model=n,this.acceleration=i,this.baseMaxSpeed=s,this.weight=o,this.brakePower=m,this.maneuverability=a,this.rotation=d,this.cameraDistance=g,this.cameraRotationY=p,this.cameraRotationX=c}}class w{constructor(){this.cars=[{id:0,name:"Muscle",model:"Muscle.glb",acceleration:1.5,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuverability:20,rotation:.01,cameraDistance:800,cameraRotationY:400,cameraRotationX:0},{id:1,name:"Sedan",model:"Sedan.glb",acceleration:2,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuverability:10,rotation:.01,cameraDistance:800,cameraRotationY:400,cameraRotationX:0},{id:2,name:"Mazda rx7",model:"mazda_rx7_stylised.glb",acceleration:1.1,baseMaxSpeed:50,weight:1e3,brakePower:1,maneuverability:10,rotation:.03,cameraDistance:800,cameraRotationY:400,cameraRotationX:0}]}getCars(){for(let e in this.cars){let t=new E(this.cars[e].id,this.cars[e].name,this.cars[e].model,this.cars[e].acceleration,this.cars[e].baseMaxSpeed,this.cars[e].weight,this.cars[e].brakePower,this.cars[e].maneuverability,this.cars[e].rotation,this.cars[e].cameraDistance,this.cars[e].cameraRotationY,this.cars[e].cameraRotationX);this.cars[t.id]=t}return console.log(this.cars),this.cars}}class y{constructor(){this.html=document.getElementById("html-vue-player").innerHTML,this.displayPlayer=null}initializePlayer(e){this.displayPlayer=e}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html}}const b="modulepreload",v=function(r){return"/"+r},f={},h=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),m=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.all(t.map(a=>{if(a=v(a),a in f)return;f[a]=!0;const d=a.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(!!n)for(let l=s.length-1;l>=0;l--){const u=s[l];if(u.href===a&&(!d||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${g}`))return;const c=document.createElement("link");if(c.rel=d?"stylesheet":b,d||(c.as="script",c.crossOrigin=""),c.href=a,m&&c.setAttribute("nonce",m),document.head.appendChild(c),d)return new Promise((l,u)=>{c.addEventListener("load",l),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})}))}return i.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};class T{constructor(){this.html=document.getElementById("html-vue-home-page").innerHTML,this.displayHomePage=null,this.selectedCar=0,this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initializeHomePage(e){this.displayHomePage=e}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.getElementById("name").innerText="Name: "+this.displayHomePage[this.selectedCar].name,document.getElementById("acceleration").innerText="Acceleration: "+this.displayHomePage[this.selectedCar].acceleration,document.getElementById("maneuverability").innerText="Maniability: "+this.displayHomePage[this.selectedCar].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.displayHomePage[this.selectedCar].brakePower,document.getElementById("btn-start").href=`#Game/${this.selectedCar}`}async setup(){try{const[e,{GLTFLoader:t},{default:n},i]=await Promise.all([h(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),h(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),h(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([])),h(()=>import("./index-BVBvlU2g.js").then(s=>s.i),__vite__mapDeps([2,3]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=n,this.ZingTouch=i,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.renderer.setSize(e,t),document.body.appendChild(this.renderer.domElement);const n=this.createGradientBackground();this.scene.background=n,this.addLights()}createGradientBackground(){const e=document.createElement("canvas"),t=e.getContext("2d"),n=t.createLinearGradient(0,0,0,window.innerHeight);return t.fillStyle=n,t.fillRect(0,0,e.width,e.height),new this.THREE.CanvasTexture(e)}addLights(){const e=new this.THREE.AmbientLight(16777215,2),t=new this.THREE.DirectionalLight(16777215,7);t.position.set(10,20,-10),this.scene.add(e,t)}loader(){new this.GLTFLoader().load("HomeView.glb",t=>{const n=t.scene;n.position.set(0,0,0),n.rotateY(Math.PI),this.scene.add(n)},void 0,t=>{console.error(t)})}setLinkSelectedCar(){const e=this.selectedCar;this.updateLinkSelectedCar(e)}updateLinkSelectedCar(e){document.getElementById("name").innerText="Name: "+this.displayHomePage[e].name,document.getElementById("acceleration").innerText="Acceleration: "+this.displayHomePage[e].acceleration,document.getElementById("maneuverability").innerText="Maniability: "+this.displayHomePage[e].maneuverability,document.getElementById("brakePower").innerText="Brake: "+this.displayHomePage[e].brakePower,document.getElementById("btn-start").href=`#Game/${e}`}appendSceneToDiv(){let e=document.getElementById("threejs-container");e?e.appendChild(this.renderer.domElement):console.error("Container not found")}catchSwipeEvent(){var e=document.getElementById("threejs-container"),t=new this.ZingTouch.Region(e);let n=this.selectedCar;t.bind(e,"swipe",i=>{if(console.log(i.detail),console.log(i.detail.data[0].currentDirection),i.detail.data[0].currentDirection<=225&&i.detail.data[0].currentDirection>=135)if(console.log("left"),n<=0){console.log("premiere voiture");return}else n--,console.log(n),this.updateLinkSelectedCar(n);else(i.detail.data[0].currentDirection>=315||i.detail.data[0].currentDirection<=45)&&(console.log("right"),n++,console.log(n),this.updateLinkSelectedCar(n))})}setCameraPosition(){this.camera.position.set(400,400,-800),this.camera.lookAt(0,0,0)}animate(){requestAnimationFrame(()=>this.animate()),this.TWEEN.update(),this.renderer.render(this.scene,this.camera)}startAnimation(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}}init(){this.setupScene(),this.startAnimation(),this.setLinkSelectedCar(),this.setCameraPosition(),this.loader(),this.appendSceneToDiv(),this.catchSwipeEvent()}}class P{constructor(){this.html=document.getElementById("html-vue-game").innerHTML,this.scene=null,this.camera=null,this.renderer=null,this.THREE=null,this.GLTFLoader=null,this.TWEEN=null,this.nipplejs=null,this.car,this.carModel,this.setup=this.setup.bind(this),this.tickInterval=1e3/120,this.lastTick=0,this.frameCount=0,this.fpsCounter=document.createElement("div"),this.button=document.createElement("button"),this.isPaused=!1,this.lastFpsUpdate=Date.now(),this.onWindowResize=this.onWindowResize.bind(this),window.addEventListener("resize",this.onWindowResize,!1)}initialiserCar(e){this.car=e}afficher(){document.getElementsByTagName("body")[0].innerHTML=this.html,document.body.appendChild(this.fpsCounter),document.body.appendChild(this.button),this.roadInstances=[],this.maxRoadInstances=8,this.nextRoadPositionCounter=0,this.distanceAhead=-1e3,this.fpsCounter.style.position="absolute",this.fpsCounter.style.top="10px",this.fpsCounter.style.left="10px",this.fpsCounter.style.color="white",this.fpsCounter.style.fontFamily="Arial, sans-serif",this.button.style.position="absolute",this.button.style.top="10px",this.button.style.right="10px",this.button.style.color="white",this.button.style.fontFamily="Arial, sans-serif",this.button.style.height="20px",this.button.style.width="20px",this.button.style.backgroundColor="rgb(250,250,250)",this.button.style.borderColor="rgb(250,250,250)",this.button.id="Pause"}async setup(){try{const[e,{GLTFLoader:t},{default:n},i]=await Promise.all([h(()=>import("./three.module-CwjCRhry.js"),__vite__mapDeps([])),h(()=>import("./GLTFLoader-Lm1hKXOz.js"),__vite__mapDeps([0,1])),h(()=>import("./tween.esm-BHSu4PDy.js"),__vite__mapDeps([])),h(()=>import("./nipplejs-PhMyn1IT.js").then(s=>s.n),__vite__mapDeps([4,3]))]);this.THREE=e,this.GLTFLoader=t,this.TWEEN=n,this.nipplejs=i,this.scene=new this.THREE.Scene,this.camera=new this.THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e5),this.renderer=new this.THREE.WebGLRenderer,this.setupScene()}catch(e){throw console.error("Error setting up Three.js:",e),e}}setupScene(){this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.scene.background=new this.THREE.Color(11063551),this.scene.fog=new this.THREE.FogExp2(12575709,12e-5)}addStart(){new this.GLTFLoader().load("rooad.glb",t=>{const n=t.scene;this.scene.add(n)},void 0,t=>{console.error(t)})}async loadRoad(){return new Promise((e,t)=>{new this.GLTFLoader().load("untitled.glb",i=>{const s=i.scene;e(s)},void 0,i=>{t(i)})})}async addRoad(){for(;this.roadInstances.length<this.maxRoadInstances;)try{const e=await this.loadRoad(),t=this.calculateRoadLength(e);this.nextRoadPositionCounter++;let n=this.nextRoadPositionCounter*-t;e.position.z=n,this.scene.add(e),this.roadInstances.push(e)}catch(e){console.error(e)}}calculateRoadLength(e){return new this.THREE.Box3().setFromObject(e).getSize(new this.THREE.Vector3).z}getTotalRoadLength(){let e=0;for(const t of this.roadInstances){const i=new this.THREE.Box3().setFromObject(t).getSize(new this.THREE.Vector3);e+=i.z}return e}moveRoadBehind(){if(this.roadInstances.length>0&&this.carModel&&this.carModel.position.z+7e3<this.roadInstances[0].position.z){const e=this.getTotalRoadLength();this.roadInstances[0].position.z-=e,this.roadInstances.push(this.roadInstances.shift())}}addLights(){const e=new this.THREE.AmbientLight(16777215,3),t=new this.THREE.DirectionalLight(16777215,5);t.position.set(1,1,1),this.scene.add(e,t)}loadCar(){return new Promise((e,t)=>{new this.GLTFLoader().load(this.car.model,i=>{this.carModel=i.scene,this.carModel.position.set(0,1,0),this.carModel.rotateY(Math.PI),this.carModel.scale.set(.8,.8,.8),this.scene.add(this.carModel),e()},void 0,i=>{console.error(i),t(i)})})}mouvements(){const e=this.car.rotation,t=document.getElementById("joystick-container"),n=this.nipplejs.create({zone:t,mode:"dynamic",color:"yellow"});n.on("move",(i,s)=>{if(s&&s.direction){const o=s.direction.x;o==="right"?(console.log("La voiture tourne à droite"),this.carModel.rotation.y<.3&&(this.carModel.rotation.y+=e)):o==="left"&&(console.log("La voiture tourne à gauche"),this.carModel.rotation.y>-.3&&(this.carModel.rotation.y-=e))}}),n.on("end",()=>{const i=()=>{Math.abs(this.carModel.rotation.y)>.01&&(this.carModel.rotation.y>0?this.carModel.rotation.y-=e:this.carModel.rotation.y<0&&(this.carModel.rotation.y+=e),requestAnimationFrame(i))};i()})}moveCarForward(){const e=this.car.baseMaxSpeed,t=this.carModel.rotation.y,n=Math.sin(t)*e,i=-Math.cos(t)*e;this.carModel.position.x+=n,this.carModel.position.z+=i}setCameraPosition(){const e=new this.THREE.Vector3(this.car.cameraRotationX,this.car.cameraRotationY,this.car.cameraDistance),t=new this.THREE.Vector3;t.copy(this.carModel.position).add(e),this.camera.position.copy(t),this.camera.lookAt(this.carModel.position),this.camera.rotation.x-=-.2}async update(){if(!this.isPaused){this.frameCount++;const e=Date.now(),t=e-this.lastTick,n=e-this.lastFpsUpdate;if(n>=1e3){const i=Math.round(this.frameCount*1e3/n);this.fpsCounter.textContent=`FPS: ${i}`,this.frameCount=0,this.lastFpsUpdate=e}if(t>=this.tickInterval){this.TWEEN.update();try{this.moveRoadBehind(),this.moveCarForward(),this.setCameraPosition(),this.renderer.render(this.scene,this.camera)}catch(i){console.error("Error in game loop:",i)}this.lastTick=e-t%this.tickInterval}}}animate(){requestAnimationFrame(()=>{this.update(),this.animate()})}changePauseState(){this.isPaused=!this.isPaused,console.log(this.isPaused)}checkButtonClick(){document.getElementById("Pause").addEventListener("pointerdown",()=>{this.changePauseState()})}startGameLoop(){this.animate()}onWindowResize(){if(this.camera&&this.renderer){const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.renderer.render(this.scene,this.camera)}}async init(){this.setupScene(),await this.loadCar(),this.addStart(),this.addLights(),this.mouvements(),this.checkButtonClick(),await this.addRoad(),this.startGameLoop()}}class R{constructor(){this.html=document.getElementById("html-vue-end-screen").innerHTML}afficher(){console.log("afficher")}}class L{constructor(e,t,n,i,s,o){this.window=e,this.carDAO=t,this.vuePlayer=o,this.vueHomePage=n,this.vueGame=i,this.vueEndScreen=s,this.window.addEventListener("hashchange",()=>this.naviger()),this.naviger()}naviger(){let e=window.location.hash;if(!e)this.vuePlayer.initializePlayer(),this.vuePlayer.afficher();else if(e.match(/^#HomePage/))this.vueHomePage.initializeHomePage(this.carDAO.getCars()),this.vueHomePage.afficher(),this.vueHomePage.setup().then(()=>{this.vueHomePage.init()}).catch(t=>console.error(t));else if(e.match(/^#Game\/([0-9]+)/)){let n=e.match(/^#Game\/([0-9]+)/)[1];this.vueGame.initialiserCar(this.carDAO.getCars()[n]),this.vueGame.afficher(),this.vueGame.setup().then(()=>{this.vueGame.init()}).catch(i=>console.error(i))}else e.match(/^#EndScreen/)&&this.vueEndScreen.afficher()}}new L(window,new w,new T,new P,new R,new y);
